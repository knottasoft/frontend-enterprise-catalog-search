{"version":3,"sources":["../../src/data/reducer.js"],"names":["DELETE_REFINEMENT","SET_REFINEMENT","CLEAR_REFINEMENTS","SET_REFINEMENTS_FROM_QUERY_PARAMS","ADD_TO_REFINEMENT_ARRAY","REMOVE_FROM_REFINEMENT_ARRAY","QUERY_PARAMS_TO_IGNORE","refinementsReducer","state","action","nextState","type","page","key","value","Object","keys","forEach","includes","payload","currentValue","filter"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA,SACEA,iBADF,EACqBC,cADrB,EACqCC,iBADrC,EAEEC,iCAFF,EAEqCC,uBAFrC,EAGEC,4BAHF,QAIO,WAJP;AAKA,SAASC,sBAAT,QAAuC,aAAvC;AAEA,OAAO,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,GAAwB;AAAA,MAAvBC,KAAuB,uEAAf,EAAe;AAAA,MAAXC,MAAW;;AACxD,MAAMC,SAAS,qBAAQF,KAAR,CAAf;;AACA,UAAQC,MAAM,CAACE,IAAf;AACE,SAAKX,iBAAL;AACE,aAAOU,SAAS,CAACE,IAAjB;AACA,aAAOF,SAAS,CAACD,MAAM,CAACI,GAAR,CAAhB;AACA,aAAOH,SAAP;;AACF,SAAKT,cAAL;AACE,aAAOS,SAAS,CAACE,IAAjB;AACAF,MAAAA,SAAS,CAACD,MAAM,CAACI,GAAR,CAAT,GAAwBJ,MAAM,CAACK,KAA/B;AACA,aAAOJ,SAAP;;AACF,SAAKP,iCAAL;AACE;AACA;AACA;AACA;AACAY,MAAAA,MAAM,CAACC,IAAP,CAAYR,KAAZ,EAAmBS,OAAnB,CAA2B,UAACJ,GAAD,EAAS;AAClC;AACA,YAAI,CAACP,sBAAsB,CAACY,QAAvB,CAAgCL,GAAhC,CAAL,EAA2C;AACzC,iBAAOH,SAAS,CAACG,GAAD,CAAhB;AACD;AACF,OALD;AAMA,6CACKH,SADL,GAEKD,MAAM,CAACU,OAFZ;;AAIF,SAAKf,uBAAL;AAA8B;AAC5B,eAAOM,SAAS,CAACE,IAAjB;AACA,YAAMQ,YAAY,GAAGZ,KAAK,CAACC,MAAM,CAACI,GAAR,CAAL,IAAqB,EAA1C;AACA,+CACKH,SADL,2BAEGD,MAAM,CAACI,GAFV,+BAEoBO,YAFpB,IAEkCX,MAAM,CAACK,KAFzC;AAID;;AACD,SAAKT,4BAAL;AAAmC;AACjC,YAAIK,SAAS,CAACD,MAAM,CAACI,GAAR,CAAb,EAA2B;AACzB,iBAAOH,SAAS,CAACE,IAAjB;;AACA,cAAMQ,aAAY,GAAGZ,KAAK,CAACC,MAAM,CAACI,GAAR,CAAL,IAAqB,EAA1C;;AACA,iDACKH,SADL,2BAEGD,MAAM,CAACI,GAFV,EAEgBO,aAAY,CAACC,MAAb,CAAoB,UAAAP,KAAK;AAAA,mBAAIA,KAAK,KAAKL,MAAM,CAACK,KAArB;AAAA,WAAzB,CAFhB;AAID;;AACD,eAAOJ,SAAP;AACD;;AACD,SAAKR,iBAAL;AACE,aAAOQ,SAAS,CAACE,IAAjB;AACAG,MAAAA,MAAM,CAACC,IAAP,CAAYN,SAAZ,EAAuBO,OAAvB,CAA+B,UAACJ,GAAD,EAAS;AACtC,YAAI,CAACP,sBAAsB,CAACY,QAAvB,CAAgCL,GAAhC,CAAL,EAA2C;AACzC,iBAAOH,SAAS,CAACG,GAAD,CAAhB;AACD;AACF,OAJD;AAKA,aAAOH,SAAP;;AACF;AACE,aAAOA,SAAP;AApDJ;AAsDD,CAxDM","sourcesContent":["/* eslint-disable import/prefer-default-export */\nimport {\n  DELETE_REFINEMENT, SET_REFINEMENT, CLEAR_REFINEMENTS,\n  SET_REFINEMENTS_FROM_QUERY_PARAMS, ADD_TO_REFINEMENT_ARRAY,\n  REMOVE_FROM_REFINEMENT_ARRAY,\n} from './actions';\nimport { QUERY_PARAMS_TO_IGNORE } from './constants';\n\nexport const refinementsReducer = (state = {}, action) => {\n  const nextState = { ...state };\n  switch (action.type) {\n    case DELETE_REFINEMENT:\n      delete nextState.page;\n      delete nextState[action.key];\n      return nextState;\n    case SET_REFINEMENT:\n      delete nextState.page;\n      nextState[action.key] = action.value;\n      return nextState;\n    case SET_REFINEMENTS_FROM_QUERY_PARAMS:\n      // we don't delete the page when setting multiple refinements.\n      // This action should only be used by SearchData,\n      //  and it has to handle the page coming in as a query param.\n      // Deleting it can cause an infinite loop.\n      Object.keys(state).forEach((key) => {\n        // remove refinements that are not from query params\n        if (!QUERY_PARAMS_TO_IGNORE.includes(key)) {\n          delete nextState[key];\n        }\n      });\n      return {\n        ...nextState,\n        ...action.payload,\n      };\n    case ADD_TO_REFINEMENT_ARRAY: {\n      delete nextState.page;\n      const currentValue = state[action.key] || [];\n      return {\n        ...nextState,\n        [action.key]: [...currentValue, action.value],\n      };\n    }\n    case REMOVE_FROM_REFINEMENT_ARRAY: {\n      if (nextState[action.key]) {\n        delete nextState.page;\n        const currentValue = state[action.key] || [];\n        return {\n          ...nextState,\n          [action.key]: currentValue.filter(value => value !== action.value),\n        };\n      }\n      return nextState;\n    }\n    case CLEAR_REFINEMENTS:\n      delete nextState.page;\n      Object.keys(nextState).forEach((key) => {\n        if (!QUERY_PARAMS_TO_IGNORE.includes(key)) {\n          delete nextState[key];\n        }\n      });\n      return nextState;\n    default:\n      return nextState;\n  }\n};\n"],"file":"reducer.js"}